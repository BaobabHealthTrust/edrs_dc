<style type="text/css">
		
		#table_container{

				height: calc(88% - 20px);

				overflow-y: scroll;

				margin-bottom : 0.3em

		}
		#summary td {

				background: #ffffff;
				text-align: left !important;
				padding: 10px;
				padding-left: 10px;

		}
		.clickable{

			font-weight: bold;
		}
		.clickable:hover{

				color: #3e98c6;

				cursor: pointer;

		}

</style>

<% if User.current_user.activities_by_level("#{@facility_type}").include?("Check for duplicates") %>

	<% if @status.status=="NEW" %>

		<button class="green" style="position:absolute; right : 170px;  bottom:58px;" onmousedown="checkCompleteness()">Completeness Check</button>

	<%else%>

		<button class="gray" style="position:absolute; right : 170px;  bottom:58px;">Completeness Check</button>

	<%end%>

		<button class="green" style="position:absolute; right : 415px;  bottom:58px;" onmousedown="markAsPending()">Mark Pending</button>


		<button class="blue" style="position:absolute; right : 590px;  bottom:58px;" onmousedown="viewPersonComment()">View Comment</button>
<% end %>

<% if User.current_user.activities_by_level("#{@facility_type}").include?("Approve a record") %>
	
	<%if  @status.present? && @status.status == "DC APPROVED" %>

			<button class="gray" style="position:absolute; right : 170px;  bottom:58px;">Approve</button>
	<%else %>

			<button class="green" style="position:absolute; right : 170px;  bottom:58px;" onmousedown="approveRecord()">Approve</button>

	<%end%>

<%end%>

<% if User.current_user.activities_by_level("#{@facility_type}").include?("Approve a record") %>

	<%if  @status.present? && @status.status == "DC REJECTED" %>

		<button class="gray" style="position:absolute; right : 295px;  bottom:58px;">Reject</button>
	<%else%>

		<button class="red" style="position:absolute; right : 295px;  bottom:58px;" onmousedown="rejectRecord()">Reject</button>

	<%end%>

<%end%>

<div id="table_container">

		<table id="summary">
			
			<tr>
				<th colspan="11">Section 1 : Particulars of the deased</th>
			</tr>

			<tr>
				<td rowspan="11" style="background-color:#dbdada;">PART 1 <br/>PERSONAL DETAILS OF DECEASED</td>
				<td>1</td>
				<td  class="clickable" onclick="editField('last_name')">Surname</td>
				<td colspan="2" ><%= @person.last_name %></td>
				<td class="clickable" onclick="editField('first_name')" >First name</td>
				<td  colspan="2"><%= @person.first_name %></td>
				<td class="clickable" onclick="editField('middle_name')" >Other</td>
				<td colspan="2"><%= @person.middle_name rescue "" %></td>
			</tr>
			<tr>
				<td>2</td>
				<td class="clickable" onclick="editField('id_number')" >ID No.</td>
				<td style="border-bottom :1.5px solid black"><%= @person.id_number rescue ""%></td>
				<td>3</td>
				<td class="clickable" onclick="editField('nationality_id')">Nationality</td>
				<td colspan="2" style="border-bottom :1.5px solid black"><%= @person.nationality rescue ""%></td>
				<td>4</td>
				<td class="clickable" onclick="editField('gender')">Sex</td>
				<td style="border-bottom:1.5px solid black"> <%= @person.gender %></td>
			</tr>
			<tr>
				<td>5</td>
				<td class="clickable" onclick="editField('birthdate')" >Birth Date</td>
				<td style="border-bottom: 1.5px solid black" colspan="5"><%= Date.parse(@person.birthdate.to_s).strftime("%d/%b/%Y") %></td>
				<td rowspan="2">6</td>
				<td rowspan="2" class="clickable" onclick="editField('birth_certificate_number')" >Birth certificate No.</td>
				<td rowspan="2" style="border-bottom :1.5px solid black"><%= @person.birth_certificate_number %></td>
			</tr>
			<tr>
				<td>7</td>
				<td class="clickable" onclick="editField('date_of_death')" >Date of Death</td>
				<td style="border-bottom: 1.5px solid black" colspan="5"><%= Date.parse(@person.date_of_death.to_s).strftime("%d/%b/%Y") %></td>
			</tr>
			<tr>
				<td rowspan="4">8</td>
				<td class="clickable" onclick="editField('place_of_death')" >Place of birth</td>
				<td colspan="9"><%= @person.place_of_death %></td>
			</tr>
			<tr>
				<td class="clickable" onclick="editField('hospital_of_death')" >Health Facility</td>
				<td colspan="8" style="border-bottom: 1.5px solid black"> <%= @person_place_details['hospital_of_death'] %></td>
			</tr>
			<tr>
				<td class="clickable" onclick="editField('hospital_of_death')" >Home</td>
				<td>Address</td>
				<td class="clickable" onclick="editField('home_district')" >District</td>
				<td style="border-bottom:1.5px solid black"><%= @person_place_details['home_district'] %></td>
				<td class="clickable" onclick="editField('home_district')">TA</td>
				<td style="border-bottom:1.5px solid black"><%= @person_place_details['home_ta'] %></td>
				<td class="clickable" onclick="editField('home_district')" >Village</td>
				<td style="border-bottom:1.5px solid black" colspan="2"><%= @person_place_details['home_village'] %></td>
			</tr>
			<tr>
				<td>Other</td>
				<td colspan="8"></td>
			</tr>
			<tr>
				<td>9</td>
				<td colspan="3">Physical residential address</td>
				<td class="clickable" onclick="editField('current_district')" >District </td>
				<td><%= @person_place_details['current_district'] %></td>
				<td class="clickable" onclick="editField('current_ta')">TA</td>
				<td><%= @person_place_details['current_ta'] %></td>
				<td class="clickable" onclick="editField('current_village')" >Village</td>
				<td><%= @person_place_details['current_village'] %></td>
			</tr>
			<tr>
				<td rowspan="2">11</td>
				<td colspan="8" class="clickable" onclick="editField('died_while_pegnant')" >In case this is a female death, did the death occur while pregnant, at the time of delivery or within 6 weeks after the end of pregnancy?</td>
				<td><%= @person.died_while_pegnant rescue "No" %></td>
			</tr>
			<tr>
				
				<td colspan="9"></td>
			</tr>
			<tr>
				<td rowspan="6">PART 2 <br/><br/>DETAILS OF PARENT</td>
				<td rowspan="3">1</td>
				<td colspan="6" class="clickable" onclick="editField('mother_name')" >Mother's name</td>
				<td rowspan="3">2</td>
				<td rowspan="3" class="clickable" onclick="editField('mother_id_number')">ID No.</td>
				<td rowspan ="3" style="border-bottom:1.5px solid black"><%= @person.mother_id_number %></td>
			</tr>
			<tr>
				<td class="clickable" onclick="editField('mother_last_name')" >Surname</td>
				<td colspan="2"><%= @person.mother_last_name %></td>
				<td class="clickable" onclick="editField('mother_first_name')" >First name</td>
				<td colspan="2"><%= @person.mother_first_name %></td>
			</tr>
			<tr>
				<td class="clickable" onclick="editField('mother_middle_name')">Other names</td>
				<td colspan="5"><%= @person.mother_middle_name %></td>
			</tr>
			<tr>
				<td rowspan="3">3</td>
				<td colspan="6" class="clickable" onclick="editField('father_id_number')">Father's name</td>
				<td rowspan="3">4</td>
				<td rowspan="3" class="clickable" onclick="editField('father_id_number')">ID No.</td>
				<td rowspan ="3" style="border-bottom:1.5px solid black"><%= @person.father_id_number %></td>
			</tr>
			<tr>
				<td class="clickable" onclick="editField('father_last_name')">Surname</td>
				<td colspan="2"><%= @person.father_last_name %></td>
				<td class="clickable" onclick="editField('father_first_name')">First name</td>
				<td colspan="2"><%= @person.father_first_name %></td>
			</tr>
			<tr>
				<td class="clickable" onclick="editField('father_middle_name')">Other names</td>
				<td colspan="5"><%= @person.father_middle_name %></td>
			</tr>

			<tr>
				<td rowspan="7" style="background-color:#dbdada;">PART 3 <br/>INFORMANTS DETAILS</td>
				<td rowspan="2">1</td>
				<td class="clickable" onclick="editField('informant_last_name')" >Surname</td>
				<td colspan="2"><%= @person.informant_last_name %></td>
				<td class="clickable" onclick="editField('informant_first_name')">First name</td>
				<td colspan="2"><%= @person.informant_first_name %></td>
				<td rowspan="2">2</td>
				<td rowspan="2" class="clickable" onclick="editField('informant_id_number')">ID No.</td>
				<td rowspan="2"><%= @person.informant_id_number %></td>
			</tr>
			<tr>
				<td class="clickable" onclick="editField('informant_middle_name')">Other name</td>
				<td colspan="5"><%= @person.informant_middle_name %></td>
			</tr>
			<tr>
				<td>3</td>
				<td class="clickable" onclick="editField('informant_relationship_to_deceased')">Relation to the deceased</td>
				<td colspan="8">
					<%= @person.informant_relationship_to_deceased rescue @person.informant_relationship_to_deceased_other %>
				</td>
			</tr>
			<tr>
				<td rowspan="2">4</td>
				<td>Adress</td>
				<td class="clickable" onclick="editField('informant_current_district')">District</td>
				<td colspan="2"><%= @person_place_details['informant_current_district'] %></td>
				<td class="clickable" onclick="editField('informant_current_ta')">TA</td>
				<td colspan="2"><%= @person_place_details['informant_current_ta'] %></td>
				<td class="clickable" onclick="editField('informant_current_village')">Village</td>
				<td><%= @person_place_details['informant_current_village'] %></td>
			</tr>
			<tr>
				<td class="clickable" onclick="editField('informant_address')">Postal address :</td>
				<td colspan="6">
					<%= @person.informant_addressline1 rescue "" %>
					<%= " #{@person.informant_addressline2}" rescue ""%>
					<%= " #{@person.informant_city}" rescue "" %>	
				</td>
				<td class="clickable" onclick="editField('informant_phone_number')">Telephone Number</td>
				<td><%= @person.informant_phone_number %></td>
			</tr>
			<tr>
				<td rowspan="2">5</td>
				<th colspan="9" style="background: #ffffff; color:black">I certify that the above information is correct and I am aware that I could face criminal prosecution if this information is incorrect in material respect.</th>
			</tr>
			<tr>
				<td>Date:</td>
				<td colspan="8"><%= Date.parse(@person.informant_signature_date.to_s).strftime("%d/%b/%Y") rescue "" %></td>
			</tr>
		</table>

</div>
<script type="text/javascript">
			<% if params[:error] %>

					showPopupMessage("<%=params[:error]%>","<%= params[:topic]%>")

			<% end %>
	
			function checkCompleteness(){

					var url ="/check_completeness/<%= @person.id %>?next_url=<%=params[:next_url]%>";

							
					showConfirmMessage("","Data Completeness check",url,"#79a3c1")

					popUpRecordDetails();
			

			}

			function approveRecord(){

					var url = "/dc/approve_record/<%= @person.id%>?next_url=<%=params[:next_url]%>";

					showConfirmMessage("","Approve record",url,"#79a3c1")

					popUpRecordDetails();

			}

			function rejectRecord(){

					var url = "/dc/add_rejection_comment/<%= @person.id%>?next_url=<%=params[:next_url]%>";

					showConfirmMessage("","Proceed to reject a record?",url,"red")

					popUpRecordDetails();

			}

			function popUpRecordDetails(){

					var control = __$("msg.content")

					var table = document.createElement("table");

					table.style.width = "80%";

					table.style.margin ="auto";

					control.appendChild(table);

					var tr = document.createElement("tr");

					table.appendChild(tr);

					var td = document.createElement("td");

					td.innerHTML = "Surnaame";

					tr.appendChild(td);

					var td = document.createElement("td");

					td.innerHTML = "<%= @person.last_name %>";

					tr.appendChild(td);

					var tr = document.createElement("tr");

					table.appendChild(tr);

					var td = document.createElement("td");

					td.innerHTML = "First Name";

					tr.appendChild(td);

					var td = document.createElement("td");

					td.innerHTML = "<%= @person.first_name %>";

					tr.appendChild(td);

			}

			function editField(field){

					<% if User.current_user.activities_by_level("#{@facility_type}").include?("Edit a record") %>

							showConfirmMessage("Are you sure u want to edit the field?", "Edit field", "/people/edit/<%= @person.id %>/"+field,"#e2a648")

					<%end%>

			}


</script>