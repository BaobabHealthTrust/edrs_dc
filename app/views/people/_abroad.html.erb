<script type="text/javascript">
    var site_type = "<%= site_type %>";
    String.prototype.capitalize = function(lower) {
        return (lower ? this.toLowerCase() : this).replace(/(?:^|\s)\S/g, function(a) { return a.toUpperCase(); });
    };
</script>
<script src="/assets/edrs.js"></script>
<script src="/assets/form.js"></script>
<%= form_for @person, :url => '/people/create', :method => :post do |f| %>
	<input type="hidden" name="person[registration_type]" id="person_registration_type" value="<%=params[:registration_type]%>">
	<input type="hidden" name="person[delayed_registration]" id="person_delayed_registration"value="No">
	<% if params[:registration_type].include? "Missing" || true%>
		<section name="Court Order">
			<sub id="person_court_order_section" name="Court order attached">
				<%= select_tag("person[court_order]",options_for_select([" ", "Yes", "No"], nil),:helpText =>"Court order attached?",:tt_requireNextClick => false, :tt_onUnLoad=>"courtOrder()") %>
			</sub>
		</section>
	<%end%>
	<% if true %>
		<section name="Barcode">
			<sub id="person_barcode_section" name="Barcode">
				<%= text_field_tag "person[barcode]",nil , {:helpText=> "Scan Form Barcode <i style='color: red'>*</i>",:tt_pageStyleClass =>"NoKeyboard",:tt_onUnLoad=>"removeDollar();checkBarcode()"} %>
			</sub>
		</section>
	<%end%>
    <section name="Personal details of deceased">
            <%= render :partial => "name_and_dob" %>
            <sub id="death_details" name="Details of death">
                <%= (f.text_field :date_of_death,
                				  :helpText => "Date of Death <i style='color: red'>*</i>",
                				  :field_type => "date" ,
                				  :tt_onLoad =>"removeUnknown()",
                				  :tt_onUnLoad => "validateDeathDate()") rescue "" %>

                <%= text_field_tag "person[place_of_death_country]", nil, {
                    					:helpText => "Place of Death Country <i style='color: red'>*</i>" , 
                    					:ajaxURL => "/countries?exclude=Malawi&search_string="} %> 

               <input type="hidden" id="person_place_of_death" name="person[place_of_death]" value="Other">

               <%= (f.text_field :other_place_of_death,
                						:helpText => "Place of death details <i style='color: red'>*</i>") rescue "" %>                
             
            </sub>

            <% render :partial => "physical_address" %>

            <%= render :partial => "home_address" %>

            <sub id='pregnancy_status' name="Pregnancy status">
               <%= select_tag("person[died_while_pregnant]", options_for_select(['No', 'Yes'], @person[:died_while_pregnant]),
                        :helpText =>"Did the death occur while pregnant?(<i style='font-size: 18px'> at the time of delivery or within 6 weeks after the end of pregnancy</i>)", 
                        :condition =>"validatePregnancy()",
                        :tt_requireNextClick => false,
                        :tt_onUnLoad=>"flagIfOut()") %>
            </sub>
  	</section>

  	<%= render :partial => "parents_details" %>

    <%= render :partial => "informant" %>

    <% if site_type == "dc" %>
    <section name="Verification">
            <sub id="village_headman_verification" name="Village head verification">
                <%= select_tag("person[headman_verified]", options_for_select(['Yes','No'], @person[:headman_verified]),
                					:helpText =>"Village headman/Block leader signed?",:tt_requireNextClick => false) %>

                <%= (f.text_field :headman_verification_date,
                				  :helpText => "Date Village headman/Block leader signed",
                                  :field_type => "date",
                                  :condition => "__$('person_headman_verified').value.trim().toLowerCase() =='yes'",
                                  :tt_onLoad =>"removeUnknown()") rescue "" %>
            </sub>
            <sub id="church_verification" name="Church verification">
                <%= select_tag("person[church_verified]", options_for_select(['Yes','No'], @person[:church_verified]),
                		:helpText =>"Senior Member of Village/Religious institution signed?",:tt_requireNextClick => false) %>

                <%= (f.text_field :church_verification_date,
                				:helpText => "Date Senior member of village/Religious institution signed",
		                        :field_type => "date",
		                        :condition => "__$('person_church_verified').value.trim().toLowerCase() =='yes'",
		                        :tt_onLoad =>"removeUnknown()") rescue "" %>
            </sub>
    </section>
    <% end %>

    <% if false %>

    <section name="Acknowledgement of Receipt">
        	<sub id="acknowledgement_of_receipt" name="Acknowledgement of Receipt">
        		<%= (f.text_field :acknowledgement_of_receipt_date,
        						  :helpText => "Acknowledgement of receipt date",
                                  :field_type => "date",
                                  :tt_onLoad =>"removeUnknown()") rescue "" %>
        	</sub>
    </section>


    <% end %>
    <input type="hidden" name="potential_duplicate" id="potential_duplicate" condition="false">

    <section name="Captured data">
        <sub id="captured_data" name="Captured Data">
		     <%= text_field_tag "summary", nil, {:helpText => 'Summary', :tt_onLoad=>"checkForDuplicate();loadPersonSummary()"} %>
        </sub>
    </section>  

<% end %>